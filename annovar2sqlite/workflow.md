Converting ANNOVAR annotated file and import into sqlite database
===================================================================

After variants calling using GATK and filtering based on the genotype call from cases and controls, a vcf file containing multiple samples was obtained. The vcf file were then annotated using [annovar_talbe.pl](http://annovar.openbioinformatics.org/en/latest/misc/accessory/) with different databases. In order to facilitate data querying later on, the annovar annotation results should be imported into a SQL supported database.

#What we have in the annovar annotated file
The annovar annotated file with a extention "hg19_multianno.txt" contains a headline, This header could be very long (in this case, there are 81 items), and dynamic (items' positions could be changed by different users). for instance:

```
Chr Start End Ref Alt cytoBand Func.refGene Gene.refGene GeneDetail.refGene ExonicFunc.refGene AAChange.refGene Interpro_domain avsnp144 genomicSuperDups ExAC_ALL ExAC_AFR ExAC_AMExAC_EAS ExAC_FIN ExAC_NFE ExAC_OTH ExAC_SAS esp6500siv2_all 1000g2015aug_all esp6500siv2_ea esp6500siv2_aa 1000g2015aug_eur 1000g2015aug_afr 1000g2015aug_amr 1000g2015aug_eas 1000g2015aug_saKaviar_AF Kaviar_AC Kaviar_AN HRC_AF HRC_AC HRC_AN HRC_non1000G_AF HRC_non1000G_AC HRC_non1000G_AN wgRna tfbsConsSites gwasCatalog clinvar_20150629 SIFT_score SIFT_pred Polyphen2_HDIV_score Polyphen2_HDIV_pred Polyphen2_HVAR_score Polyphen2_HVAR_pred LRT_score LRT_pred MutationTaster_score MutationTaster_pred MutationAssessor_score MutationAssessor_pred FATHMM_score FATHMM_pred PROVEAN_score PROVEAN_pred VEST3_score CADD_raw CADD_phred DANN_score fathmm-MKL_coding_score fathmm-MKL_coding_pred MetaSVM_score MetaSVM_pred MetaLR_score MetaLR_pred integrated_fitCons_score integrated_confidence_value GERP++_RS phyloP7way_vertebrate phyloP20way_mammalian phastCons7way_vertebrate phastCons20way_mammalian SiPhy_29way_logOdds targetScanS dbscSNV_ADA_SCORE dbscSNV_RF_SCORE dpsi_max_tissue dpsi_zscore Otherinfo
```
The content of annovar annotated file is a mix of annotation and orignial vcf data (with [-otherinfo](http://annovar.openbioinformatics.org/en/latest/misc/accessory/) arguement during annoation)

```
chr1 865694 865694 C T 1p36.33 exonic SAMD11 . nonsynonymous SNV SAMD11:NM_152486:exon3:c.C232T:p.H78Y . rs9988179 . 0.0381 0.0344 0.1602 0.1605 0.0020 0.0023 0.0351 0.0345 0.0073 0.052516 0.0016 0.0185 0.002 0.0227 0.0965 0.1389 0.0245 0.0234085 3619 154602 0.00564824 367 64976 0.00150035 90 59986 . . . . 0.006 D 0.989 D 0.637 P 0.006 N 0.591 0.895 L . . -3.99 D 0.206 2.789 21.3 0.996 0.739 D -1.084 T 0.001 T 0.598 0 4.72 0.823 0.787 0.039 0.002 17.060 . . . 0.5360 1.168 0.004323 1960.1534 chr1 865694 rs9988179 C T 1960.15 PASS AC=3;AF=0.004323;AN=694;BaseQRankSum=-2.867;ClippingRankSum=0.352;DB;DP=11040;FS=1.111;InbreedingCoeff=-0.0043;MLEAC=3;MLEAF=0.004323;MQ=60;MQRankSum=0.261;POSITIVE_TRAIN_SITE;QD=9.7;ReadPosRankSum=-0.712;SOR=0.788;VQSLOD=16.99;culprit=QD GT:AD:DP:GQ:PL 0/0:42,0:42:99:0,102,1512 0/0:21,0:21:60:0,60,900 0/0:11,0:11:30:0,30,450 0/0:22,0:22:60:0,60,900 0/0:23,0:23:63:0,63,938 0/0:33,0:33:93:0,93,1395 0/0:38,0:38:99:0,99,1480/0:27,0:27:72:0,72,1080 0/0:23,0:23:63:0,63,945 0/0:29,0:29:84:0,84,1260 0/0:34,0:34:99:0,99,1485 0/0:41,0:41:99:0,108,1620 0/0:38,0:38:99:0,99,1485 0/0:31,0:31:81:0,81,1215 0/0:17,0:17:39:0,39,585 0/0:40,0:40:99:0,102,1530 0/0:23,0:23:60:0,60,900 0/0:28,0:28:72:0,72,1080 0/0:37,0:37:99:0,99,1485 0/0:35,0:35:99:0,99,1376 0/0:40,0:40:99:0,108,1419 0/0:32,0:32:81:0,81,1215 0/0:41,0:41:99:0,99,1485 0/0:37,0:37:99:0,99,1481 0/0:36,0:36:99:0,99,1485 0/0:37,0:37:99:0,99,1485 0/0:25,0:25:63:0,63,945 0/0:37,0:37:81:0,81,1215 0/0:29,0:29:78:0,78,1170 0/0:20,0:20:48:0,48,720 0/0:21,0:21:60:0,60,900 0/0:38,0:38:99:0,105,1367 0/0:35,0:35:99:0,99,1218 0/0:38,0:38:99:0,99,1485 0/0:34,0:34:87:0,87,1305 0/0:37,0:37:99:0,99,1485 0/0:19,0:19:57:0,57,727 0/0:27,0:27:75:0,75,1125 0/0:23,0:23:60:0,60,826 0/0:36,0:36:99:0,99,1485 0/0:22,0:22:60:0,60,900 0/0:24,0:24:63:0,63,945 0/0:22,0:22:60:0,60,900 0/0:25,0:25:66:0,66,990 0/0:34,0:34:90:0,90,1350 0/0:34,0:34:90:0,90,1350 0/0:31,0:31:81:0,81,1215 0/0:24,0:24:63:0,63,945 0/0:31,0:31:90:0,90,1350 0/0:27,0:27:72:0,72,1080 0/0:34,0:34:93:0,93,1395 0/0:23,0:23:60:0,60,900 0/0:23,0:23:54:0,54,810 0/0:16,0:16:42:0,42,630 0/0:29,0:29:81:0,81,1215 0/0:27,0:27:75:0,75,1125 0/0:30,0:30:84:0,84,1260 0/0:22,0:22:51:0,51,765 0/0:26,0:26:72:0,72,1080 0/0:28,0:28:72:0,72,1080 0/0:35,0:35:93:0,93,1395 0/0:16,0:16:42:0,42,630 0/0:36,0:36:99:0,99,1485 0/0:31,0:31:81:0,81,1215 0/0:22,0:22:57:0,57,855 0/0:29,0:29:72:0,72,1080 0/0:29,0:29:81:0,81,1215 0/0:21,0:21:60:0,60,900 0/0:33,0:33:90:0,90,1350 0/0:31,0:31:81:0,81,1215 0/0:22,0:22:60:0,60,900 0/0:27,0:27:72:0,72,1080 0/0:32,0:32:90:0,90,1350 0/0:28,0:28:81:0,81,1215 0/0:24,0:24:60:0,60,900 0/0:37,0:37:99:0,99,1485 0/0:39,0:39:99:0,105,1575 0/0:32,0:32:81:0,81,1210/0:13,0:13:39:0,39,488 0/0:25,0:25:75:0,75,914 0/0:30,0:30:81:0,81,1215 0/0:29,0:29:84:0,84,1260 0/0:28,0:28:81:0,81,986 0/0:31,0:31:81:0,81,1204 0/0:36,0:36:99:0,99,1485 0/0:25,0:25:72:0,72,1080 0/0:24,0:24:60:0,60,9000/0:20,0:20:51:0,51,765 0/0:28,0:28:75:0,75,1125 0/0:39,0:39:99:0,99,1485 0/0:22,0:22:54:0,54,810 0/0:33,0:33:90:0,90,1350 0/0:34,0:34:90:0,90,1222 0/0:20,0:20:60:0,60,662 0/0:22,0:22:60:0,60,900 0/0:29,0:29:72:0,72,1076 0/0:30,0:30:81:0,81,1215 0/0:15,0:15:42:0,42,630 0/0:30,0:30:81:0,81,1199 0/0:34,0:34:96:0,96,1440 0/0:34,0:34:90:0,90,1350 0/0:32,0:32:90:0,90,1350 0/0:33,0:33:90:0,90,1350 0/0:36,0:36:93:0,93,1395 0/0:21,0:21:57:0,57,855 0/0:16,0:16:45:0,45,675 0/0:32,0:32:90:0,90,1350 0/0:35,0:35:99:0,99,1207 0/0:21,0:21:57:0,57,855 0/0:16,0:16:45:0,45,675 0/0:33,0:33:90:0,90,1350 0/0:35,0:35:90:0,90,1350 0/0:20,0:20:51:0,51,765 0/0:22,0:22:60:0,60,9000/0:28,0:28:81:0,81,1215 0/0:17,0:17:51:0,51,619 0/1:23,12:35:99:312,0,797 0/0:26,0:26:72:0,72,1080 0/0:17,0:17:48:0,48,720 0/0:30,0:30:90:0,90,1089 0/0:30,0:30:81:0,81,1215 0/0:11,0:11:33:0,33,472 0/0:27,0:27:81:0,81,987 0/0:23,0:23:57:0,57,855 0/0:36,0:36:90:0,90,1350 0/0:35,0:35:99:0,99,1485 0/0:25,0:25:43:0,43,943 0/0:32,0:32:81:0,81,1215 0/0:37,0:37:93:0,93,1395 0/0:15,0:15:39:0,39,585 0/0:34,0:34:99:0,99,1485 0/0:38,0:38:99:0,102,1530 0/0:25,0:25:60:0,60,900 0/0:36,0:36:99:0,99,1322 0/0:38,0:38:99:0,99,1291 0/0:21,0:21:60:0,60,900 0/0:35,0:35:90:0,90,1350 0/0:37,0:37:99:0,99,1365 0/0:37,0:37:99:0,99,1308 0/0:33,0:33:81:0,81,1215 0/0:28,0:28:81:0,81,1215 0/0:24,0:24:60:0,60,900 0/0:24,0:24:60:0,60,900 0/0:21,0:21:60:0,60,799 0/0:33,0:33:90:0,90,1350 0/0:37,0:37:99:0,99,1376 0/0:33,0:33:90:0,90,1350 0/0:23,0:23:51:0,51,765 0/0:20,0:20:51:0,51,765 0/0:37,0:37:99:0,99,1480/0:28,0:28:81:0,81,1009 0/0:20,0:20:57:0,57,855 0/0:20,0:20:51:0,51,765 0/0:31,0:31:90:0,90,1350 0/0:19,0:19:54:0,54,810 0/0:33,0:33:81:0,81,1215 0/0:30,0:30:81:0,81,1215 0/0:38,0:38:99:0,99,1485 0/0:31,0:31:87:0,87,1305 0/0:32,0:32:81:0,81,1215 0/0:28,0:28:72:0,72,1080 0/0:37,0:37:99:0,99,1480 0/0:37,0:37:99:0,105,1575 0/0:22,0:22:54:0,54,810 0/0:33,0:33:81:0,81,1215 0/0:31,0:31:90:0,90,1350 0/0:16,0:16:42:0,42,630 0/0:31,0:31:93:0,93,1130/0:37,0:37:99:0,99,1485 0/0:33,0:33:96:0,96,1440 0/0:37,0:37:99:0,102,1420 0/0:21,0:21:60:0,60,723 0/0:33,0:33:99:0,99,1214 0/0:28,0:28:81:0,81,1215 0/0:21,0:21:60:0,60,875 0/0:34,0:34:90:0,90,1350 0/0:38,0:38:99:0,99,1480/0:36,0:36:99:0,99,1257 0/0:39,0:39:99:0,99,1485 0/0:41,0:41:99:0,99,1485 0/0:28,0:28:72:0,72,1080 0/0:24,0:24:60:0,60,900 0/0:24,0:24:60:0,60,900 0/0:43,0:43:99:0,102,1530 0/0:28,0:28:72:0,72,963 0/0:35,0:35:99:0,99,1485 0/0:31,0:31:90:0,90,1102 0/0:23,0:23:63:0,63,815 0/0:23,0:23:60:0,60,900 0/0:37,0:37:99:0,99,1317 0/0:39,0:39:99:0,102,1530 0/0:42,0:42:99:0,99,1485 0/0:37,0:37:99:0,100,1530 0/0:39,0:39:99:0,99,1485 0/0:41,0:41:99:0,99,1480/0:37,0:37:99:0,99,1413 0/0:37,0:37:99:0,99,1485 0/0:38,0:38:99:0,99,1428 0/0:38,0:38:99:0,99,1485 0/0:25,0:25:60:0,60,900 0/0:34,0:34:93:0,93,1395 0/0:42,0:42:99:0,105,1575 0/0:23,0:23:60:0,60,900 0/0:27,0:27:73:0,73,9330/0:22,0:22:63:0,63,860 0/0:28,0:28:81:0,81,1215 0/0:19,0:19:57:0,57,697 0/0:28,0:28:81:0,81,1215 0/0:29,0:29:81:0,81,1215 0/0:18,0:18:54:0,54,648 0/0:26,0:26:72:0,72,1080 0/0:29,0:29:81:0,81,1215 0/0:26,0:26:72:0,72,9330/0:24,0:24:60:0,60,900 0/0:34,0:34:90:0,90,1350 0/0:16,0:16:48:0,48,588 0/0:17,0:17:48:0,48,720 0/0:28,0:28:68:0,68,1048 0/0:32,0:32:81:0,81,1215 0/0:20,0:20:48:0,48,720 0/0:24,0:24:63:0,63,945 0/0:22,0:22:63:0,63,945 0/0:23,0:23:60:0,60,900 0/0:34,0:34:99:0,99,1199 0/0:28,0:28:75:0,75,1125 0/0:29,0:29:72:0,72,1080 0/0:31,0:31:78:0,78,1170 0/0:28,0:28:63:0,63,945 0/0:38,0:38:99:0,102,1370 0/0:34,0:34:81:0,81,1215 0/0:34,0:34:90:0,90,1350 0/0:31,0:31:81:0,81,1215 0/0:34,0:34:90:0,90,1350 0/0:33,0:33:87:0,87,1305 0/0:38,0:38:99:0,100,1428 0/0:32,0:32:90:0,90,1032 0/0:40,0:40:99:0,99,1485 0/0:40,0:40:99:0,99,1485 0/0:32,0:32:90:0,90,1350 0/0:37,0:37:99:0,99,1485 0/0:36,0:36:99:0,102,1303 0/0:43,0:43:99:0,105,1342 0/0:40,0:40:99:0,105,1575 0/0:35,0:35:99:0,105,1237 0/0:37,0:37:99:0,99,1485 0/0:38,0:38:99:0,99,1272 0/0:34,0:34:99:0,99,1249 0/0:38,0:38:99:0,105,1535 0/0:37,0:37:99:0,99,1485 0/0:42,0:42:99:0,109,1656 0/0:41,0:41:99:0,101,1620 0/0:22,0:22:54:0,54,810 0/0:39,0:39:99:0,101,1465 0/0:37,0:37:99:0,99,1485 0/0:18,0:18:51:0,51,765 0/0:43,0:43:99:0,99,1480/0:30,0:30:81:0,81,1215 0/0:29,0:29:81:0,81,1215 0/0:35,0:35:99:0,99,1386 0/0:24,0:24:60:0,60,900 0/0:30,0:30:90:0,90,1206 0/0:43,0:43:99:0,108,1620 0/0:22,0:22:60:0,60,900 0/0:33,0:33:99:0,99,1270 0/0:23,0:23:60:0,60,9000/0:32,0:32:90:0,90,1350 0/0:43,0:43:99:0,99,1485 0/0:30,0:30:72:0,72,1080 0/0:38,0:38:99:0,101,1276 0/0:28,0:28:81:0,81,1215 0/0:41,0:41:99:0,105,1575 0/0:32,0:32:84:0,84,1260 0/0:44,0:44:99:0,102,1530 0/0:38,0:38:99:0,99,1416 0/0:20,0:20:54:0,54,810 0/0:42,0:42:99:0,105,1336 0/0:41,0:41:99:0,105,1392 0/0:36,0:36:99:0,99,1485 0/0:34,0:34:90:0,90,1350 0/0:43,0:43:99:0,99,1485 0/0:47,0:47:99:0,114,1465 0/0:30,0:30:81:0,81,1215 0/0:34,0:34:93:0,93,1395 0/0:41,0:41:99:0,99,1485 0/0:41,0:41:99:0,105,1575 0/0:40,0:40:99:0,102,1620 0/0:38,0:38:99:0,99,1205 0/0:40,0:40:99:0,99,1373 0/0:39,0:39:99:0,102,1530 0/0:17,0:17:48:0,48,720 0/0:45,0:45:99:0,99,1485 0/0:43,0:43:99:0,104,1667 0/0:37,0:37:99:0,99,1485 0/0:39,0:39:99:0,102,1431 0/0:20,0:20:45:0,45,675 0/0:37,0:37:87:0,87,1305 0/0:39,0:39:99:0,99,1485 0/0:32,0:32:93:0,93,1097 0/0:28,0:28:81:0,81,1215 0/0:41,0:41:99:0,102,1197 0/0:36,0:36:99:0,99,1485 0/0:35,0:35:99:0,99,1132 0/0:41,0:41:99:0,99,1485 0/0:36,0:36:99:0,102,1286 0/0:42,0:42:99:0,111,1567 0/0:43,0:43:99:0,102,1530 0/0:34,0:34:99:0,99,1485 0/0:37,0:37:99:0,99,1485 0/0:40,0:40:99:0,111,1665 0/0:36,0:36:99:0,102,1530 0/0:38,0:38:99:0,99,1485 0/0:34,0:34:99:0,99,1278 0/0:43,0:43:99:0,120,1800 0/0:36,0:36:99:0,99,1485 0/0:33,0:33:99:0,99,1075 0/0:35,0:35:99:0,99,1291 0/0:39,0:39:99:0,102,1530 0/0:45,0:45:99:0,99,1485 0/0:35,0:35:99:0,99,1315 0/0:34,0:34:99:0,99,1356 0/0:44,0:44:99:0,114,1710 0/0:37,0:37:99:0,99,1485 0/1:42,31:73:99:624,0,1110 0/0:38,0:38:99:0,99,1485 0/0:44,0:44:99:0,102,1392 0/0:36,0:36:99:0,102,1335 0/0:33,0:33:99:0,99,1088 0/0:36,0:36:99:0,99,1453 0/0:36,0:36:99:0,99,1274 0/0:35,0:35:99:0,99,1149 0/0:40,0:40:99:0,102,1301 0/0:35,0:35:99:0,99,1254 0/0:44,0:44:99:0,110,1363 0/0:35,0:35:99:0,99,1485 0/0:37,0:37:99:0,102,1331 0/0:35,0:35:99:0,99,1485 0/0:49,0:49:98:0,98,1505 0/0:46,0:46:99:0,102,1530 0/0:33,0:33:99:0,99,1121 0/0:37,0:37:99:0,104,1354 0/0:36,0:36:99:0,99,1086 0/0:34,0:34:99:0,102,1263 0/1:48,46:94:99:1114,0,1409 0/0:33,0:33:99:0,99,1296 0/0:34,0:34:99:0,99,1485 0/0:36,0:36:99:0,99,1485 0/0:34,0:34:99:0,99,1102
```
As we can see, each line annotates a single variant. The first half is the annotation information. The second half is the original information from the vcf file. Blanks were noted by "." in the first half. 

#What we want from the SQLite database
After importing all information to the database, we should be able to:
  - quickly query information based on combination of the annotation items.
  - generate new vcf files that only contains variants fiting to the query
  - generate new annotation files that contains variants fiting to the query

#Step by Step to achive the goal
###Read an annotation file
```python
import sys
import os
# Read the annovar annotation file
if len(sys.argv)==2 and sys.argv[1].endswith("hg19_multianno.txt"):
  try:
    f = open(sys.argv[1], 'r')
  except IOError:
    print "Could not read file:", sys.argv[1]
    sys.exit()
else:
    print '''
    Incorrect number of arguments or filename extension .
    Please input:
    python annovar2sqlite.py example.hg19_multianno.txt
    '''
print f.readline()
f.close()
```
###Create a new SQLite database with the given annotation file name
```python
# filename is sys.argv[1][:-len("hg19_multianno.txt")]
def create_database(filename):
  
```




